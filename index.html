<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CA Firm Pro - Complete Practice Management</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Lucide Icon Components
        const Calendar = (props) => <i data-lucide="calendar" {...props}></i>;
        const Users = (props) => <i data-lucide="users" {...props}></i>;
        const FileText = (props) => <i data-lucide="file-text" {...props}></i>;
        const DollarSign = (props) => <i data-lucide="dollar-sign" {...props}></i>;
        const CheckSquare = (props) => <i data-lucide="check-square" {...props}></i>;
        const TrendingUp = (props) => <i data-lucide="trending-up" {...props}></i>;
        const BookOpen = (props) => <i data-lucide="book-open" {...props}></i>;
        const Calculator = (props) => <i data-lucide="calculator" {...props}></i>;
        const Briefcase = (props) => <i data-lucide="briefcase" {...props}></i>;
        const Bell = (props) => <i data-lucide="bell" {...props}></i>;
        const Search = (props) => <i data-lucide="search" {...props}></i>;
        const Plus = (props) => <i data-lucide="plus" {...props}></i>;
        const X = (props) => <i data-lucide="x" {...props}></i>;
        const Edit2 = (props) => <i data-lucide="edit-2" {...props}></i>;
        const Save = (props) => <i data-lucide="save" {...props}></i>;
        const Download = (props) => <i data-lucide="download" {...props}></i>;
        const Upload = (props) => <i data-lucide="upload" {...props}></i>;
        const Filter = (props) => <i data-lucide="filter" {...props}></i>;
        const Clock = (props) => <i data-lucide="clock" {...props}></i>;
        const Mail = (props) => <i data-lucide="mail" {...props}></i>;
        const Phone = (props) => <i data-lucide="phone" {...props}></i>;
        const MapPin = (props) => <i data-lucide="map-pin" {...props}></i>;
        const Building = (props) => <i data-lucide="building" {...props}></i>;
        const CreditCard = (props) => <i data-lucide="credit-card" {...props}></i>;
        const AlertCircle = (props) => <i data-lucide="alert-circle" {...props}></i>;
        const CheckCircle = (props) => <i data-lucide="check-circle" {...props}></i>;
        const XCircle = (props) => <i data-lucide="x-circle" {...props}></i>;
        const BarChart3 = (props) => <i data-lucide="bar-chart-3" {...props}></i>;
        const PieChart = (props) => <i data-lucide="pie-chart" {...props}></i>;
        const Eye = (props) => <i data-lucide="eye" {...props}></i>;
        const Trash2 = (props) => <i data-lucide="trash-2" {...props}></i>;
        const MoreVertical = (props) => <i data-lucide="more-vertical" {...props}></i>;
        const Archive = (props) => <i data-lucide="archive" {...props}></i>;
        const Send = (props) => <i data-lucide="send" {...props}></i>;
        const User = (props) => <i data-lucide="user" {...props}></i>;
        const Settings = (props) => <i data-lucide="settings" {...props}></i>;
        const LogOut = (props) => <i data-lucide="log-out" {...props}></i>;
        const ChevronDown = (props) => <i data-lucide="chevron-down" {...props}></i>;
        const ChevronRight = (props) => <i data-lucide="chevron-right" {...props}></i>;
        const Paperclip = (props) => <i data-lucide="paperclip" {...props}></i>;
        const MessageSquare = (props) => <i data-lucide="message-square" {...props}></i>;
        const Star = (props) => <i data-lucide="star" {...props}></i>;
        const Tag = (props) => <i data-lucide="tag" {...props}></i>;
        const Printer = (props) => <i data-lucide="printer" {...props}></i>;
        const Share2 = (props) => <i data-lucide="share-2" {...props}></i>;
        const RefreshCw = (props) => <i data-lucide="refresh-cw" {...props}></i>;

        const AdvancedCAFirmApp = () => {
          const [activeTab, setActiveTab] = useState('dashboard');
          const [searchTerm, setSearchTerm] = useState('');
          const [filterStatus, setFilterStatus] = useState('all');
          const [showModal, setShowModal] = useState(false);
          const [modalType, setModalType] = useState('');
          const [selectedItem, setSelectedItem] = useState(null);
          const [showNotifications, setShowNotifications] = useState(false);

          // Load data from localStorage on mount
          const [clients, setClients] = useState(() => {
            const saved = localStorage.getItem('caClients');
            return saved ? JSON.parse(saved) : [
              { 
                id: 1, 
                name: 'ABC Enterprises Ltd', 
                type: 'Corporate', 
                status: 'Active', 
                services: ['Accounting', 'Tax Filing', 'Audit', 'GST Returns'],
                email: 'contact@abc.com',
                phone: '+91-9876543210',
                address: '123 Business Park, Delhi',
                gstNumber: '07AAACA1234A1Z5',
                panNumber: 'AAACA1234A',
                revenue: 2500000,
                since: '2020-01-15',
                contactPerson: 'Mr. Rajesh Kumar',
                billingCycle: 'Monthly',
                retainerFee: 50000,
                documents: [],
                notes: 'Premium client, requires monthly reports',
                priority: 'High',
                tags: ['Premium', 'Corporate'],
                lastInteraction: '2026-02-01'
              },
              { 
                id: 2, 
                name: 'Tech Startup Pvt Ltd', 
                type: 'Corporate', 
                status: 'Active', 
                services: ['Bookkeeping', 'Payroll', 'GST Returns'],
                email: 'finance@techstartup.com',
                phone: '+91-9876543211',
                address: '45 IT Park, Bangalore',
                gstNumber: '29AABCT1234A1Z1',
                panNumber: 'AABCT1234A',
                revenue: 1200000,
                since: '2022-06-10',
                contactPerson: 'Ms. Priya Sharma',
                billingCycle: 'Quarterly',
                retainerFee: 25000,
                documents: [],
                notes: 'Fast-growing startup, needs advisory support',
                priority: 'Medium',
                tags: ['Startup', 'Tech'],
                lastInteraction: '2026-01-28'
              },
              { 
                id: 3, 
                name: 'John Doe', 
                type: 'Individual', 
                status: 'Active', 
                services: ['Tax Filing', 'Financial Advisory'],
                email: 'john.doe@email.com',
                phone: '+91-9876543212',
                address: '78 Green Avenue, Mumbai',
                panNumber: 'ABCDE1234F',
                revenue: 500000,
                since: '2021-03-20',
                contactPerson: 'John Doe',
                billingCycle: 'Annual',
                retainerFee: 15000,
                documents: [],
                notes: 'Individual tax planning required',
                priority: 'Low',
                tags: ['Individual', 'HNI'],
                lastInteraction: '2026-01-15'
              }
            ];
          });

          const [tasks, setTasks] = useState(() => {
            const saved = localStorage.getItem('caTasks');
            return saved ? JSON.parse(saved) : [
              { 
                id: 1, 
                clientId: 1,
                client: 'ABC Enterprises Ltd', 
                service: 'GST Return Filing', 
                deadline: '2026-02-15', 
                status: 'In Progress', 
                priority: 'High',
                assignedTo: 'Amit Kumar',
                startDate: '2026-02-01',
                estimatedHours: 8,
                actualHours: 4,
                description: 'Monthly GST return for January 2026',
                checklist: [
                  { task: 'Collect purchase invoices', completed: true },
                  { task: 'Verify sales data', completed: true },
                  { task: 'Reconcile ITC', completed: false },
                  { task: 'File GSTR-1', completed: false },
                  { task: 'File GSTR-3B', completed: false }
                ],
                attachments: [],
                comments: [],
                tags: ['GST', 'Monthly'],
                billable: true,
                amount: 5000
              },
              { 
                id: 2, 
                clientId: 2,
                client: 'Tech Startup Pvt Ltd', 
                service: 'Payroll Processing', 
                deadline: '2026-02-10', 
                status: 'In Progress', 
                priority: 'High',
                assignedTo: 'Priya Singh',
                startDate: '2026-02-05',
                estimatedHours: 6,
                actualHours: 3,
                description: 'January 2026 payroll processing',
                checklist: [
                  { task: 'Collect attendance data', completed: true },
                  { task: 'Calculate salaries', completed: true },
                  { task: 'Process TDS', completed: false },
                  { task: 'Generate payslips', completed: false }
                ],
                attachments: [],
                comments: [],
                tags: ['Payroll', 'Monthly'],
                billable: true,
                amount: 3000
              },
              { 
                id: 3, 
                clientId: 3,
                client: 'John Doe', 
                service: 'ITR Filing AY 2025-26', 
                deadline: '2026-07-31', 
                status: 'Not Started', 
                priority: 'Medium',
                assignedTo: 'Rahul Verma',
                startDate: '2026-06-01',
                estimatedHours: 4,
                actualHours: 0,
                description: 'Individual tax return filing',
                checklist: [
                  { task: 'Collect Form 16', completed: false },
                  { task: 'Gather investment proofs', completed: false },
                  { task: 'Calculate tax liability', completed: false },
                  { task: 'File ITR', completed: false }
                ],
                attachments: [],
                comments: [],
                tags: ['ITR', 'Individual'],
                billable: true,
                amount: 2500
              },
              { 
                id: 4, 
                clientId: 1,
                client: 'ABC Enterprises Ltd', 
                service: 'Annual Audit', 
                deadline: '2026-09-30', 
                status: 'Not Started', 
                priority: 'High',
                assignedTo: 'CA Suresh Patel',
                startDate: '2026-07-01',
                estimatedHours: 120,
                actualHours: 0,
                description: 'Statutory audit for FY 2025-26',
                checklist: [
                  { task: 'Planning and risk assessment', completed: false },
                  { task: 'Internal control evaluation', completed: false },
                  { task: 'Substantive testing', completed: false },
                  { task: 'Draft audit report', completed: false },
                  { task: 'Finalize audit report', completed: false }
                ],
                attachments: [],
                comments: [],
                tags: ['Audit', 'Annual'],
                billable: true,
                amount: 150000
              }
            ];
          });

          const [invoices, setInvoices] = useState(() => {
            const saved = localStorage.getItem('caInvoices');
            return saved ? JSON.parse(saved) : [
              { 
                id: 1, 
                invoiceNumber: 'INV-2026-001',
                clientId: 1,
                client: 'ABC Enterprises Ltd', 
                service: 'Monthly Retainer - January 2026', 
                amount: 50000,
                cgst: 4500,
                sgst: 4500,
                total: 59000,
                status: 'Paid', 
                issueDate: '2026-01-31',
                dueDate: '2026-02-10',
                paidDate: '2026-02-08',
                paymentMethod: 'Bank Transfer',
                notes: 'Monthly retainer fee',
                items: [
                  { description: 'Monthly Accounting Services', quantity: 1, rate: 30000, amount: 30000 },
                  { description: 'GST Return Filing', quantity: 1, rate: 10000, amount: 10000 },
                  { description: 'Compliance Review', quantity: 1, rate: 10000, amount: 10000 }
                ]
              },
              { 
                id: 2, 
                invoiceNumber: 'INV-2026-002',
                clientId: 2,
                client: 'Tech Startup Pvt Ltd', 
                service: 'Payroll Processing - January 2026', 
                amount: 15000,
                cgst: 1350,
                sgst: 1350,
                total: 17700,
                status: 'Pending', 
                issueDate: '2026-02-01',
                dueDate: '2026-02-15',
                paidDate: null,
                paymentMethod: null,
                notes: 'Payroll for 25 employees',
                items: [
                  { description: 'Payroll Processing', quantity: 25, rate: 500, amount: 12500 },
                  { description: 'TDS Computation', quantity: 1, rate: 2500, amount: 2500 }
                ]
              },
              { 
                id: 3, 
                invoiceNumber: 'INV-2026-003',
                clientId: 1,
                client: 'ABC Enterprises Ltd', 
                service: 'Annual Audit - Advance Payment', 
                amount: 50000,
                cgst: 4500,
                sgst: 4500,
                total: 59000,
                status: 'Overdue', 
                issueDate: '2026-01-15',
                dueDate: '2026-01-30',
                paidDate: null,
                paymentMethod: null,
                notes: 'Advance payment for annual audit',
                items: [
                  { description: 'Audit Services - Advance (33%)', quantity: 1, rate: 50000, amount: 50000 }
                ]
              }
            ];
          });

          const [staff, setStaff] = useState(() => {
            const saved = localStorage.getItem('caStaff');
            return saved ? JSON.parse(saved) : [
              { id: 1, name: 'CA Suresh Patel', role: 'Senior Partner', email: 'suresh@cafirm.com', phone: '+91-9876543220', specialization: 'Audit & Assurance', status: 'Active', joinDate: '2015-04-01', billableRate: 3000, utilization: 85 },
              { id: 2, name: 'Amit Kumar', role: 'Tax Manager', email: 'amit@cafirm.com', phone: '+91-9876543221', specialization: 'Direct & Indirect Tax', status: 'Active', joinDate: '2018-07-15', billableRate: 2000, utilization: 90 },
              { id: 3, name: 'Priya Singh', role: 'Accounts Manager', email: 'priya@cafirm.com', phone: '+91-9876543222', specialization: 'Accounting & Bookkeeping', status: 'Active', joinDate: '2019-02-20', billableRate: 1500, utilization: 88 },
              { id: 4, name: 'Rahul Verma', role: 'Senior Associate', email: 'rahul@cafirm.com', phone: '+91-9876543223', specialization: 'Compliance & Advisory', status: 'Active', joinDate: '2020-09-10', billableRate: 1200, utilization: 75 }
            ];
          });

          const [expenses, setExpenses] = useState(() => {
            const saved = localStorage.getItem('caExpenses');
            return saved ? JSON.parse(saved) : [
              { id: 1, category: 'Office Rent', amount: 50000, date: '2026-02-01', vendor: 'Property Management', status: 'Paid', description: 'Monthly office rent' },
              { id: 2, category: 'Software Licenses', amount: 15000, date: '2026-02-01', vendor: 'Tally Solutions', status: 'Paid', description: 'Annual subscription' },
              { id: 3, category: 'Staff Salaries', amount: 350000, date: '2026-02-01', vendor: 'Staff', status: 'Paid', description: 'January salaries' },
              { id: 4, category: 'Utilities', amount: 8000, date: '2026-02-02', vendor: 'Electricity Board', status: 'Pending', description: 'Electricity bill' }
            ];
          });

          const [notifications, setNotifications] = useState([
            { id: 1, type: 'deadline', message: 'GST Return Filing for ABC Enterprises due in 11 days', time: '2 hours ago', read: false },
            { id: 2, type: 'payment', message: 'Payment received from ABC Enterprises - ₹59,000', time: '5 hours ago', read: false },
            { id: 3, type: 'task', message: 'New task assigned: ITR Filing for John Doe', time: '1 day ago', read: true },
            { id: 4, type: 'invoice', message: 'Invoice INV-2026-003 is overdue', time: '5 days ago', read: false }
          ]);

          // Save to localStorage whenever data changes
          useEffect(() => {
            localStorage.setItem('caClients', JSON.stringify(clients));
          }, [clients]);

          useEffect(() => {
            localStorage.setItem('caTasks', JSON.stringify(tasks));
          }, [tasks]);

          useEffect(() => {
            localStorage.setItem('caInvoices', JSON.stringify(invoices));
          }, [invoices]);

          useEffect(() => {
            localStorage.setItem('caStaff', JSON.stringify(staff));
          }, [staff]);

          useEffect(() => {
            localStorage.setItem('caExpenses', JSON.stringify(expenses));
          }, [expenses]);

          // Initialize Lucide icons
          useEffect(() => {
            if (window.lucide) {
              window.lucide.createIcons();
            }
          });

          // Computed metrics
          const metrics = useMemo(() => {
            const totalRevenue = invoices.filter(inv => inv.status === 'Paid').reduce((sum, inv) => sum + inv.total, 0);
            const pendingRevenue = invoices.filter(inv => inv.status === 'Pending').reduce((sum, inv) => sum + inv.total, 0);
            const overdueRevenue = invoices.filter(inv => inv.status === 'Overdue').reduce((sum, inv) => sum + inv.total, 0);
            const totalExpenses = expenses.filter(exp => exp.status === 'Paid').reduce((sum, exp) => sum + exp.amount, 0);
            const activeTasks = tasks.filter(t => t.status !== 'Completed').length;
            const highPriorityTasks = tasks.filter(t => t.priority === 'High' && t.status !== 'Completed').length;
            const overdueTasksCount = tasks.filter(t => new Date(t.deadline) < new Date() && t.status !== 'Completed').length;
            const activeClients = clients.filter(c => c.status === 'Active').length;
            const avgRealizationRate = tasks.filter(t => t.actualHours > 0).reduce((sum, t) => sum + (t.actualHours / t.estimatedHours), 0) / tasks.filter(t => t.actualHours > 0).length || 0;

            return {
              totalRevenue,
              pendingRevenue,
              overdueRevenue,
              totalExpenses,
              netProfit: totalRevenue - totalExpenses,
              activeTasks,
              highPriorityTasks,
              overdueTasksCount,
              activeClients,
              avgRealizationRate: (avgRealizationRate * 100).toFixed(1)
            };
          }, [invoices, expenses, tasks, clients]);

          // Modal handlers
          const openModal = (type, item = null) => {
            setModalType(type);
            setSelectedItem(item);
            setShowModal(true);
          };

          const closeModal = () => {
            setShowModal(false);
            setSelectedItem(null);
          };

          // CRUD operations
          const handleAddClient = (clientData) => {
            const newClient = {
              id: clients.length + 1,
              ...clientData,
              status: 'Active',
              documents: [],
              notes: clientData.notes || '',
              lastInteraction: new Date().toISOString().split('T')[0]
            };
            setClients([...clients, newClient]);
            closeModal();
          };

          const handleUpdateClient = (id, clientData) => {
            setClients(clients.map(c => c.id === id ? { ...c, ...clientData } : c));
            closeModal();
          };

          const handleDeleteClient = (id) => {
            if (window.confirm('Are you sure you want to delete this client?')) {
              setClients(clients.filter(c => c.id !== id));
            }
          };

          const handleAddTask = (taskData) => {
            const newTask = {
              id: tasks.length + 1,
              ...taskData,
              status: 'Not Started',
              actualHours: 0,
              checklist: [],
              attachments: [],
              comments: []
            };
            setTasks([...tasks, newTask]);
            closeModal();
          };

          const handleUpdateTask = (id, taskData) => {
            setTasks(tasks.map(t => t.id === id ? { ...t, ...taskData } : t));
            closeModal();
          };

          const handleDeleteTask = (id) => {
            if (window.confirm('Are you sure you want to delete this task?')) {
              setTasks(tasks.filter(t => t.id !== id));
            }
          };

          const handleAddInvoice = (invoiceData) => {
            const subtotal = invoiceData.items.reduce((sum, item) => sum + item.amount, 0);
            const cgst = subtotal * 0.09;
            const sgst = subtotal * 0.09;
            const newInvoice = {
              id: invoices.length + 1,
              invoiceNumber: `INV-2026-${String(invoices.length + 1).padStart(3, '0')}`,
              ...invoiceData,
              amount: subtotal,
              cgst,
              sgst,
              total: subtotal + cgst + sgst,
              status: 'Pending',
              issueDate: new Date().toISOString().split('T')[0]
            };
            setInvoices([...invoices, newInvoice]);
            closeModal();
          };

          const handleUpdateInvoice = (id, invoiceData) => {
            setInvoices(invoices.map(inv => inv.id === id ? { ...inv, ...invoiceData } : inv));
            closeModal();
          };

          const handleMarkPaid = (id, paymentMethod) => {
            setInvoices(invoices.map(inv => 
              inv.id === id ? { 
                ...inv, 
                status: 'Paid', 
                paidDate: new Date().toISOString().split('T')[0],
                paymentMethod 
              } : inv
            ));
          };

          // Filter functions
          const filteredClients = clients.filter(client => {
            const matchesSearch = client.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                 client.email.toLowerCase().includes(searchTerm.toLowerCase());
            const matchesStatus = filterStatus === 'all' || client.status.toLowerCase() === filterStatus.toLowerCase();
            return matchesSearch && matchesStatus;
          });

          const filteredTasks = tasks.filter(task => {
            const matchesSearch = task.client.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                 task.service.toLowerCase().includes(searchTerm.toLowerCase());
            const matchesStatus = filterStatus === 'all' || task.status.toLowerCase().includes(filterStatus.toLowerCase());
            return matchesSearch && matchesStatus;
          });

          const filteredInvoices = invoices.filter(invoice => {
            const matchesSearch = invoice.client.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                 invoice.invoiceNumber.toLowerCase().includes(searchTerm.toLowerCase());
            const matchesStatus = filterStatus === 'all' || invoice.status.toLowerCase() === filterStatus.toLowerCase();
            return matchesSearch && matchesStatus;
          });

          // Components
          const MetricCard = ({ title, value, subtitle, icon: Icon, color, trend, alert }) => (
            <div className="bg-white p-6 rounded-lg shadow">
              <div className="flex items-center justify-between mb-2">
                <p className="text-gray-600 text-sm font-medium">{title}</p>
                <Icon className={`w-8 h-8 text-${color}-500`} />
              </div>
              <div className="space-y-1">
                <p className="text-3xl font-bold text-gray-800">{value}</p>
                <div className="flex items-center justify-between">
                  <p className="text-sm text-gray-500">{subtitle}</p>
                  {trend && (
                    <span className={`text-xs font-medium ${trend.startsWith('+') ? 'text-green-600' : 'text-red-600'}`}>
                      {trend}
                    </span>
                  )}
                </div>
                {alert && (
                  <div className="flex items-center gap-1 text-xs text-red-600 mt-2">
                    <AlertCircle className="w-3 h-3" />
                    <span>{alert}</span>
                  </div>
                )}
              </div>
            </div>
          );

          const Dashboard = () => (
            <div className="space-y-6">
              {/* Key Metrics */}
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <MetricCard 
                  title="Total Revenue" 
                  value={`₹${(metrics.totalRevenue / 100000).toFixed(2)}L`}
                  subtitle={`Pending: ₹${(metrics.pendingRevenue / 1000).toFixed(0)}K`}
                  icon={TrendingUp} 
                  color="blue"
                  trend="+12.5%"
                />
                <MetricCard 
                  title="Net Profit" 
                  value={`₹${(metrics.netProfit / 100000).toFixed(2)}L`}
                  subtitle={`Margin: ${((metrics.netProfit / metrics.totalRevenue) * 100).toFixed(1)}%`}
                  icon={DollarSign} 
                  color="green"
                  trend="+8.3%"
                />
                <MetricCard 
                  title="Active Tasks" 
                  value={metrics.activeTasks}
                  subtitle={`High Priority: ${metrics.highPriorityTasks}`}
                  icon={CheckSquare} 
                  color="purple"
                  alert={metrics.overdueTasksCount > 0 ? `${metrics.overdueTasksCount} Overdue` : null}
                />
                <MetricCard 
                  title="Active Clients" 
                  value={metrics.activeClients}
                  subtitle={`Realization: ${metrics.avgRealizationRate}%`}
                  icon={Users} 
                  color="orange"
                />
              </div>

              {/* Charts and more dashboard content... */}
              <div className="bg-white p-6 rounded-lg shadow">
                <h3 className="text-lg font-semibold mb-4 flex items-center">
                  <Bell className="w-5 h-5 mr-2 text-red-500" />
                  Critical Deadlines (Next 15 Days)
                </h3>
                <div className="space-y-3">
                  {tasks
                    .filter(t => {
                      const daysUntil = Math.ceil((new Date(t.deadline) - new Date()) / (1000 * 60 * 60 * 24));
                      return daysUntil <= 15 && t.status !== 'Completed';
                    })
                    .sort((a, b) => new Date(a.deadline) - new Date(b.deadline))
                    .slice(0, 8)
                    .map(task => {
                      const daysUntil = Math.ceil((new Date(task.deadline) - new Date()) / (1000 * 60 * 60 * 24));
                      return (
                        <div key={task.id} className="flex items-center justify-between p-3 bg-gray-50 rounded hover:bg-gray-100 cursor-pointer" onClick={() => openModal('taskDetail', task)}>
                          <div className="flex-1">
                            <p className="font-medium text-sm">{task.service}</p>
                            <p className="text-xs text-gray-600">{task.client}</p>
                          </div>
                          <div className="text-right">
                            <p className={`text-sm font-medium ${daysUntil < 0 ? 'text-red-600' : daysUntil <= 3 ? 'text-orange-600' : 'text-gray-800'}`}>
                              {daysUntil < 0 ? `${Math.abs(daysUntil)} days overdue` : `${daysUntil} days left`}
                            </p>
                            <span className={`text-xs px-2 py-1 rounded ${
                              task.priority === 'High' ? 'bg-red-100 text-red-600' :
                              task.priority === 'Medium' ? 'bg-yellow-100 text-yellow-600' :
                              'bg-green-100 text-green-600'
                            }`}>
                              {task.priority}
                            </span>
                          </div>
                        </div>
                      );
                    })}
                </div>
              </div>
            </div>
          );

          const ClientsTab = () => (
            <div className="space-y-4">
              <div className="flex flex-wrap gap-4 items-center justify-between">
                <h2 className="text-2xl font-bold">Client Management</h2>
                <div className="flex gap-2">
                  <div className="relative">
                    <Search className="w-5 h-5 absolute left-3 top-2.5 text-gray-400" />
                    <input
                      type="text"
                      placeholder="Search clients..."
                      className="pl-10 pr-4 py-2 border rounded-lg"
                      value={searchTerm}
                      onChange={(e) => setSearchTerm(e.target.value)}
                    />
                  </div>
                  <select
                    className="px-4 py-2 border rounded-lg"
                    value={filterStatus}
                    onChange={(e) => setFilterStatus(e.target.value)}
                  >
                    <option value="all">All Status</option>
                    <option value="active">Active</option>
                    <option value="inactive">Inactive</option>
                  </select>
                  <button
                    onClick={() => openModal('addClient')}
                    className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700"
                  >
                    <Plus className="w-4 h-4" />
                    Add Client
                  </button>
                </div>
              </div>

              <div className="bg-white rounded-lg shadow">
                <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 p-4">
                  {filteredClients.map(client => (
                    <div key={client.id} className="border rounded-lg p-4 hover:shadow-lg transition-shadow">
                      <div className="flex justify-between items-start mb-3">
                        <div className="flex items-center gap-3">
                          <div className={`w-12 h-12 rounded-full flex items-center justify-center ${
                            client.type === 'Corporate' ? 'bg-blue-100' : 'bg-green-100'
                          }`}>
                            {client.type === 'Corporate' ? 
                              <Building className="w-6 h-6 text-blue-600" /> : 
                              <User className="w-6 h-6 text-green-600" />
                            }
                          </div>
                          <div>
                            <h4 className="font-semibold">{client.name}</h4>
                            <span className={`text-xs px-2 py-1 rounded ${
                              client.status === 'Active' ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-600'
                            }`}>
                              {client.status}
                            </span>
                          </div>
                        </div>
                        <div className="flex gap-1">
                          <button onClick={() => openModal('editClient', client)} className="p-1 hover:bg-gray-100 rounded">
                            <Edit2 className="w-4 h-4 text-gray-600" />
                          </button>
                          <button onClick={() => handleDeleteClient(client.id)} className="p-1 hover:bg-gray-100 rounded">
                            <Trash2 className="w-4 h-4 text-red-600" />
                          </button>
                        </div>
                      </div>
                      
                      <div className="space-y-2 text-sm mb-3">
                        <div className="flex items-center gap-2 text-gray-600">
                          <Mail className="w-4 h-4" />
                          <span className="truncate">{client.email}</span>
                        </div>
                        <div className="flex items-center gap-2 text-gray-600">
                          <Phone className="w-4 h-4" />
                          <span>{client.phone}</span>
                        </div>
                      </div>

                      <div className="border-t pt-3 space-y-2">
                        <div className="flex justify-between text-sm">
                          <span className="text-gray-600">Retainer Fee</span>
                          <span className="font-semibold">₹{client.retainerFee.toLocaleString()}</span>
                        </div>
                      </div>
                      
                      <button
                        onClick={() => openModal('clientDetail', client)}
                        className="w-full mt-3 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 flex items-center justify-center gap-2"
                      >
                        <Eye className="w-4 h-4" />
                        View Details
                      </button>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          );

          const TasksTab = () => (
            <div className="space-y-4">
              <div className="flex flex-wrap gap-4 items-center justify-between">
                <h2 className="text-2xl font-bold">Task Management</h2>
                <button
                  onClick={() => openModal('addTask')}
                  className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700"
                >
                  <Plus className="w-4 h-4" />
                  Add Task
                </button>
              </div>

              <div className="bg-white rounded-lg shadow overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Client & Service</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Assigned To</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Deadline</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Priority</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {filteredTasks.map(task => (
                      <tr key={task.id} className="hover:bg-gray-50">
                        <td className="px-6 py-4">
                          <div>
                            <p className="font-medium">{task.client}</p>
                            <p className="text-sm text-gray-600">{task.service}</p>
                          </div>
                        </td>
                        <td className="px-6 py-4 text-sm">{task.assignedTo}</td>
                        <td className="px-6 py-4 text-sm">{task.deadline}</td>
                        <td className="px-6 py-4">
                          <span className={`px-2 py-1 text-xs rounded ${
                            task.priority === 'High' ? 'bg-red-100 text-red-600' :
                            task.priority === 'Medium' ? 'bg-yellow-100 text-yellow-600' :
                            'bg-green-100 text-green-600'
                          }`}>
                            {task.priority}
                          </span>
                        </td>
                        <td className="px-6 py-4">
                          <span className={`px-2 py-1 text-xs rounded ${
                            task.status === 'Completed' ? 'bg-green-100 text-green-600' :
                            task.status === 'In Progress' ? 'bg-blue-100 text-blue-600' :
                            'bg-gray-100 text-gray-600'
                          }`}>
                            {task.status}
                          </span>
                        </td>
                        <td className="px-6 py-4">
                          <div className="flex gap-2">
                            <button onClick={() => openModal('taskDetail', task)} className="p-1 hover:bg-gray-100 rounded">
                              <Eye className="w-4 h-4 text-gray-600" />
                            </button>
                            <button onClick={() => handleDeleteTask(task.id)} className="p-1 hover:bg-gray-100 rounded">
                              <Trash2 className="w-4 h-4 text-red-600" />
                            </button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>
          );

          const InvoicesTab = () => (
            <div className="space-y-4">
              <div className="flex flex-wrap gap-4 items-center justify-between">
                <h2 className="text-2xl font-bold">Invoice Management</h2>
                <button
                  onClick={() => openModal('addInvoice')}
                  className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700"
                >
                  <Plus className="w-4 h-4" />
                  Create Invoice
                </button>
              </div>

              <div className="bg-white rounded-lg shadow overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Invoice #</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Client</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Amount</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Due Date</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {filteredInvoices.map(invoice => (
                      <tr key={invoice.id} className="hover:bg-gray-50">
                        <td className="px-6 py-4 font-medium">{invoice.invoiceNumber}</td>
                        <td className="px-6 py-4">{invoice.client}</td>
                        <td className="px-6 py-4 font-semibold">₹{invoice.total.toLocaleString()}</td>
                        <td className="px-6 py-4 text-sm">{invoice.dueDate}</td>
                        <td className="px-6 py-4">
                          <span className={`px-2 py-1 text-xs rounded ${
                            invoice.status === 'Paid' ? 'bg-green-100 text-green-600' :
                            invoice.status === 'Overdue' ? 'bg-red-100 text-red-600' :
                            'bg-yellow-100 text-yellow-600'
                          }`}>
                            {invoice.status}
                          </span>
                        </td>
                        <td className="px-6 py-4">
                          <div className="flex gap-2">
                            <button onClick={() => openModal('invoiceDetail', invoice)} className="p-1 hover:bg-gray-100 rounded">
                              <Eye className="w-4 h-4 text-gray-600" />
                            </button>
                            {invoice.status !== 'Paid' && (
                              <button onClick={() => handleMarkPaid(invoice.id, 'Bank Transfer')} className="p-1 hover:bg-gray-100 rounded">
                                <CheckCircle className="w-4 h-4 text-green-600" />
                              </button>
                            )}
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>
          );

          const StaffTab = () => (
            <div className="space-y-4">
              <h2 className="text-2xl font-bold">Staff Management</h2>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                {staff.map(member => (
                  <div key={member.id} className="bg-white p-6 rounded-lg shadow">
                    <div className="flex items-center gap-3 mb-4">
                      <div className="w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center">
                        <User className="w-8 h-8 text-indigo-600" />
                      </div>
                      <div>
                        <h4 className="font-semibold">{member.name}</h4>
                        <p className="text-sm text-gray-600">{member.role}</p>
                      </div>
                    </div>
                    <div className="space-y-2 text-sm">
                      <div className="flex justify-between">
                        <span className="text-gray-600">Utilization</span>
                        <span className="font-semibold">{member.utilization}%</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-2">
                        <div 
                          className={`h-2 rounded-full ${
                            member.utilization >= 90 ? 'bg-green-500' : 
                            member.utilization >= 70 ? 'bg-blue-500' : 
                            'bg-yellow-500'
                          }`}
                          style={{ width: `${member.utilization}%` }}
                        ></div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          );

          const NavButton = ({ icon: Icon, label, active, onClick }) => (
            <button
              onClick={onClick}
              className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${
                active 
                  ? 'bg-blue-600 text-white shadow-sm' 
                  : 'text-gray-600 hover:bg-gray-100'
              }`}
            >
              <Icon className="w-4 h-4" />
              <span className="font-medium">{label}</span>
            </button>
          );

          // Modal content components would go here (simplified for brevity)
          const SimpleModal = () => {
            if (modalType.includes('Detail')) {
              return (
                <div className="p-4">
                  <h3 className="text-lg font-bold mb-4">Details</h3>
                  <pre className="text-sm bg-gray-50 p-4 rounded overflow-auto max-h-96">
                    {JSON.stringify(selectedItem, null, 2)}
                  </pre>
                  <button onClick={closeModal} className="mt-4 w-full bg-blue-600 text-white py-2 rounded">
                    Close
                  </button>
                </div>
              );
            }
            return (
              <div className="p-4">
                <p className="text-gray-600 mb-4">Form for {modalType}</p>
                <button onClick={closeModal} className="w-full bg-blue-600 text-white py-2 rounded">
                  Close
                </button>
              </div>
            );
          };

          return (
            <div className="min-h-screen bg-gray-100">
              {/* Header */}
              <div className="bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg">
                <div className="max-w-7xl mx-auto px-4 py-4">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-3">
                      <div className="w-12 h-12 bg-white rounded-lg flex items-center justify-center">
                        <Briefcase className="w-7 h-7 text-blue-600" />
                      </div>
                      <div>
                        <h1 className="text-2xl font-bold">CA Firm Pro</h1>
                        <p className="text-xs text-blue-100">Complete Practice Management</p>
                      </div>
                    </div>
                    <div className="flex items-center gap-4">
                      <button 
                        onClick={() => setShowNotifications(!showNotifications)}
                        className="relative p-2 hover:bg-blue-500 rounded-lg"
                      >
                        <Bell className="w-6 h-6" />
                        <span className="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              {/* Navigation */}
              <div className="bg-white shadow sticky top-0 z-40">
                <div className="max-w-7xl mx-auto px-4">
                  <div className="flex gap-1 py-2 overflow-x-auto">
                    <NavButton icon={TrendingUp} label="Dashboard" active={activeTab === 'dashboard'} onClick={() => setActiveTab('dashboard')} />
                    <NavButton icon={Users} label="Clients" active={activeTab === 'clients'} onClick={() => setActiveTab('clients')} />
                    <NavButton icon={CheckSquare} label="Tasks" active={activeTab === 'tasks'} onClick={() => setActiveTab('tasks')} />
                    <NavButton icon={DollarSign} label="Invoices" active={activeTab === 'invoices'} onClick={() => setActiveTab('invoices')} />
                    <NavButton icon={User} label="Staff" active={activeTab === 'staff'} onClick={() => setActiveTab('staff')} />
                  </div>
                </div>
              </div>

              {/* Main Content */}
              <div className="max-w-7xl mx-auto px-4 py-6">
                {activeTab === 'dashboard' && <Dashboard />}
                {activeTab === 'clients' && <ClientsTab />}
                {activeTab === 'tasks' && <TasksTab />}
                {activeTab === 'invoices' && <InvoicesTab />}
                {activeTab === 'staff' && <StaffTab />}
              </div>

              {/* Modal */}
              {showModal && (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                  <div className="bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-auto">
                    <div className="flex justify-between items-center p-6 border-b sticky top-0 bg-white">
                      <h3 className="text-xl font-bold">{modalType}</h3>
                      <button onClick={closeModal} className="p-2 hover:bg-gray-100 rounded-full">
                        <X className="w-5 h-5" />
                      </button>
                    </div>
                    <SimpleModal />
                  </div>
                </div>
              )}
            </div>
          );
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<AdvancedCAFirmApp />);

        // Initialize Lucide icons after render
        setTimeout(() => {
          if (window.lucide) {
            window.lucide.createIcons();
          }
        }, 100);
    </script>
</body>
</html>